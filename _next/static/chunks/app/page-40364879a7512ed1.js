(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3686:()=>{},2383:()=>{},763:(e,a,s)=>{Promise.resolve().then(s.bind(s,4789))},4789:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>H});var t=s(5155),r=s(2115),l=s(4081),n=s(8684),o=s(7660),i=s(9022);function c(e){let{onFileSelect:a,acceptExcel:s=!1,compact:l=!1}=e,o=(0,r.useCallback)(e=>{e.length>0&&a(e[0])},[a]),{getRootProps:c,getInputProps:d,isDragActive:u}=(0,i.VB)({onDrop:o,accept:s?{"text/csv":[".csv"],"application/vnd.ms-excel":[".xls"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/csv":[".csv"],"text/x-csv":[".csv"]}:{"text/csv":[".csv"],"application/csv":[".csv"],"text/x-csv":[".csv"]},multiple:!1,validator:e=>{let a=e.name.toLowerCase().split(".").pop();if(s){if(!["csv","xls","xlsx"].includes(a||""))return{code:"file-invalid-type",message:"只支持 .csv, .xls, .xlsx 格式的文件"}}else if("csv"!==a)return{code:"file-invalid-type",message:"只支持 .csv 格式的文件"};return null}});return(0,t.jsxs)("div",{...c(),className:"border-2 border-dashed rounded-lg cursor-pointer transition-colors\n        ".concat(u?"border-primary bg-primary/5":"border-border hover:border-primary","\n        ").concat(l?"p-6":"p-12"," h-full flex flex-col items-center justify-center"),children:[(0,t.jsx)("input",{...d()}),(0,t.jsx)(n.A,{className:"".concat(l?"w-10 h-10":"w-16 h-16"," mx-auto mb-4 ").concat(u?"text-primary":"text-gray-400")}),(0,t.jsx)("p",{className:"".concat(l?"text-base":"text-xl"," font-medium text-gray-900"),children:u?"将文件拖放到这里":"拖拽文件到这里"}),(0,t.jsxs)("p",{className:"mt-1 text-sm text-gray-600",children:["或点击选择文件",s&&(0,t.jsx)("span",{className:"block mt-1",children:"支持 .csv, .xls, .xlsx 格式"})]})]})}var d=s(1556),u=s(853),m=s(4857),x=s(1290),h=s(1027),p=s(3463),v=s(9795);let f=(0,h.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),g=r.forwardRef((e,a)=>{let{className:s,variant:r,size:l,asChild:n=!1,...o}=e,i=n?x.DX:"button";return(0,t.jsx)(i,{className:function(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,v.QP)((0,p.$)(a))}(f({variant:r,size:l,className:s})),ref:a,...o})});g.displayName="Button";var b=s(2772),j=s(2060);function N(e){let{filter:a,columns:s,onUpdate:r,onRemove:l,isOnly:n,onAdd:o}=e,i=e=>{let a=[{value:"equals",label:"等于"},{value:"notEquals",label:"不等于"},{value:"isNull",label:"为空"},{value:"isNotNull",label:"不为空"}];switch(e){case"text":return[...a,{value:"contains",label:"包含"},{value:"notContains",label:"不包含"},{value:"startsWith",label:"开头是"},{value:"endsWith",label:"结尾是"}];case"number":return[...a,{value:"greaterThan",label:"大于"},{value:"lessThan",label:"小于"},{value:"between",label:"介于"}];case"date":return[...a,{value:"before",label:"早于"},{value:"after",label:"晚于"},{value:"onDate",label:"在日期"},{value:"between",label:"日期范围"}];default:return a}},c=s.find(e=>e.name===a.column),d=c?i(c.type):[];return(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,t.jsxs)("select",{className:"flex-1 min-w-[200px] p-2 border rounded-md",value:a.column,onChange:e=>{let t=s.find(a=>a.name===e.target.value);t&&r({...a,column:t.name,columnType:t.type,operator:i(t.type)[0].value,value:""})},children:[(0,t.jsx)("option",{value:"",children:"选择列"}),s.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,t.jsx)("select",{className:"flex-1 min-w-[150px] p-2 border rounded-md",value:a.operator,onChange:e=>r({...a,operator:e.target.value}),children:d.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))}),"isNull"!==a.operator&&"isNotNull"!==a.operator&&("between"===a.operator?(0,t.jsxs)("div",{className:"flex-1 min-w-[200px] flex gap-2",children:[(0,t.jsx)("input",{type:(null==c?void 0:c.type)==="date"?"date":"text",className:"flex-1 p-2 border rounded-md",placeholder:"起始值...",value:a.value[0]||"",onChange:e=>r({...a,value:[e.target.value,a.value[1]||""]})}),(0,t.jsx)("input",{type:(null==c?void 0:c.type)==="date"?"date":"text",className:"flex-1 p-2 border rounded-md",placeholder:"结束值...",value:a.value[1]||"",onChange:e=>r({...a,value:[a.value[0]||"",e.target.value]})})]}):(0,t.jsx)("input",{type:(null==c?void 0:c.type)==="date"?"date":"text",className:"flex-1 min-w-[200px] p-2 border rounded-md",placeholder:"输入值...",value:a.value,onChange:e=>r({...a,value:e.target.value})})),(0,t.jsxs)("div",{className:"flex gap-2",children:[!n&&(0,t.jsx)(g,{onClick:l,variant:"ghost",size:"icon",className:"text-red-500 hover:text-red-600 hover:bg-red-100",title:"删除筛选",children:(0,t.jsx)(b.A,{className:"w-5 h-5"})}),(0,t.jsx)(g,{onClick:o,variant:"ghost",size:"icon",className:"text-primary hover:text-primary-dark hover:bg-primary/10",title:"添加筛选",children:(0,t.jsx)(j.A,{className:"w-5 h-5"})})]})]})}let y={filters:[{id:"1",column:"",operator:"contains",value:"",columnType:"text"}],conjunction:"AND"},w={filters:[],conjunction:"AND"};function C(e){let{columns:a,onQueryChange:s,onExport:l}=e,[n,o]=(0,r.useState)(y),[i,c]=(0,r.useState)("csv"),x=(e,a)=>{let s=[...n.filters];s[e]=a,o({...n,filters:s})},h=e=>{let a=n.filters.filter((a,s)=>s!==e);o({...n,filters:a})},p=()=>{o({...n,filters:[...n.filters,{id:String(Date.now()),column:"",operator:"contains",value:"",columnType:"text"}]})},v=n.filters.some(e=>e.column&&("isNull"===e.operator||"isNotNull"===e.operator||e.value));return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-border p-6 space-y-6",children:[(0,t.jsx)("div",{className:"space-y-4",children:n.filters.map((e,s)=>(0,t.jsx)(N,{filter:e,columns:a,onUpdate:e=>x(s,e),onRemove:()=>h(s),isOnly:1===n.filters.length,onAdd:p},e.id))}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-border",children:[(0,t.jsxs)("select",{className:"px-4 py-2 border border-border rounded-lg focus:outline-none focus:border-primary transition-colors",value:n.conjunction,onChange:e=>o({...n,conjunction:e.target.value}),children:[(0,t.jsx)("option",{value:"AND",children:"匹配所有条件（AND）"}),(0,t.jsx)("option",{value:"OR",children:"匹配任一条件（OR）"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(g,{onClick:()=>{o(y),s(w)},variant:"outline",className:"flex items-center gap-2",disabled:!v,children:[(0,t.jsx)(d.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"重置"})]}),(0,t.jsxs)(g,{onClick:()=>{let e=n.filters.filter(e=>e.column&&("isNull"===e.operator||"isNotNull"===e.operator||e.value));e.length>0&&s({...n,filters:e})},className:"flex items-center gap-2",disabled:!v,children:[(0,t.jsx)(u.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"应用筛选"})]}),(0,t.jsxs)("select",{className:"px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/20",value:i,onChange:e=>c(e.target.value),children:[(0,t.jsx)("option",{value:"csv",children:"CSV"}),(0,t.jsx)("option",{value:"xls",children:"XLS"}),(0,t.jsx)("option",{value:"json",children:"JSON"})]}),(0,t.jsxs)(g,{onClick:()=>null==l?void 0:l(i),className:"flex items-center gap-2",disabled:!v,children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"导出"})]})]})]})]})}var S=s(3518),k=s(6967);let Y=[10,25,50,100];function D(e){let{currentPage:a,totalPages:s,pageSize:r,onPageChange:l,onPageSizeChange:n}=e;return(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-3 bg-white border-t border-gray-200",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:["第 ",a," 页，共 ",s," 页"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{htmlFor:"pageSize",className:"text-sm text-gray-600",children:"每页显示："}),(0,t.jsx)("select",{id:"pageSize",value:r,onChange:e=>n(Number(e.target.value)),className:"text-sm border rounded-md p-1",children:Y.map(e=>(0,t.jsx)("option",{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g,{onClick:()=>l(a-1),disabled:1===a,variant:"ghost",className:"p-2 rounded hover:bg-gray-100 disabled:opacity-50",children:(0,t.jsx)(S.A,{className:"w-5 h-5"})}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,s)},(e,r)=>{let n;return n=s<=5?r+1:a<=3?r+1:a>=s-2?s-4+r:a-2+r,(0,t.jsx)(g,{variant:a===n?"default":"outline",onClick:()=>l(n),children:n},n)})}),(0,t.jsx)(g,{onClick:()=>l(a+1),disabled:a===s,variant:"ghost",className:"p-2 rounded hover:bg-gray-100 disabled:opacity-50",children:(0,t.jsx)(k.A,{className:"w-5 h-5"})})]})]})}function E(e){let{data:a,columns:s,currentPage:r,totalPages:l,pageSize:n,onPageChange:o,onPageSizeChange:i}=e;return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-border overflow-hidden",children:[(0,t.jsx)(D,{currentPage:r,totalPages:l,pageSize:n,totalItems:a.length,onPageChange:o,onPageSizeChange:i}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full table-fixed divide-y divide-border",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{className:"bg-gray-50",children:s.map(e=>(0,t.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider w-[200px] min-w-[200px]",children:(0,t.jsx)("div",{className:"truncate",title:e,children:e})},e))})}),(0,t.jsx)("tbody",{className:"divide-y divide-border",children:0===a.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:s.length,className:"px-6 py-8 text-center text-sm text-gray-500",children:"No data available"})}):a.map((e,a)=>(0,t.jsx)("tr",{className:"hover:bg-gray-50",children:s.map(a=>(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600 w-[200px] min-w-[200px]",children:(0,t.jsx)("div",{className:"truncate",title:e[a],children:e[a]})},a))},a))})]})}),(0,t.jsx)(D,{currentPage:r,totalPages:l,pageSize:n,totalItems:a.length,onPageChange:o,onPageSizeChange:i})]})}var W=s(9159),A=s.n(W);async function M(e){return new Promise((a,s)=>{A().parse(e,{header:!0,skipEmptyLines:!0,complete:e=>{if(e.errors.length>0){s(Error("Error parsing CSV file"));return}let t=e.meta.fields||[];a({data:e.data,columns:t})},error:e=>{s(e)}})})}var T=s(1455),z=s.n(T),L=s(1909),P=s.n(L);z().extend(P());let F=["DD-MM-YYYY HH:mm:ss","MM-DD-YYYY HH:mm:ss","YYYY-MM-DD HH:mm:ss","DD/MM/YYYY HH:mm:ss","MM/DD/YYYY HH:mm:ss","YYYY/MM/DD HH:mm:ss","YYYY-MM-DD","MM/DD/YYYY","DD/MM/YYYY"];function O(e){return 0===e.length?[]:Object.keys(e[0]).map(a=>({name:a,type:function(e,a){let s=e.slice(0,100).map(e=>e[a]).filter(e=>null!=e&&""!==e);return 0===s.length?"text":s.every(e=>!isNaN(Number(e)))?"number":s.every(e=>null!=e&&""!==e&&F.some(a=>z()(e,a,!0).isValid()))?"date":s.every(e=>"boolean"==typeof e||["true","false","0","1"].includes(String(e).toLowerCase()))?"boolean":"text"}(e,a)}))}function _(e){let{sourceData:a,sourceColumns:s,onMatch:l,onExport:i}=e,[x,h]=(0,r.useState)([]),[p,v]=(0,r.useState)([]),[f,b]=(0,r.useState)({matchTableColumn:"",sourceColumn:"",matchType:"exact"}),[j,N]=(0,r.useState)("csv"),y=async e=>{try{if(e.size>0xa00000)throw Error("文件太大，请上传小于 10MB 的文件");console.log("File info:",{name:e.name,type:e.type,size:e.size,lastModified:e.lastModified});let a=[],s=e.name.toLowerCase();if(s.endsWith(".csv"))console.log("Processing as CSV file"),a=(await M(e)).data;else if(s.endsWith(".xlsx")||s.endsWith(".xls")){console.log("Processing as Excel file");let s=await e.arrayBuffer(),t=o.LF(s),r=t.SheetNames[0],l=t.Sheets[r];a=o.Wp.sheet_to_json(l)}else throw Error("不支持的文件格式，请上传 .csv, .xls 或 .xlsx 文件");let t=O(a);h(a),v(t)}catch(e){console.error("Error parsing file:",e),h([]),v([])}};return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-border p-6 space-y-6",children:0===x.length?(0,t.jsx)(c,{onFileSelect:y,acceptExcel:!0}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)(g,{onClick:()=>{h([]),v([]),b({matchTableColumn:"",sourceColumn:"",matchType:"exact"}),l(a)},variant:"outline",className:"flex items-center gap-2",children:[(0,t.jsx)(n.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"重新上传匹配表格"})]})}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,t.jsxs)("select",{className:"flex-1 min-w-[200px] p-2 border rounded-md",value:f.matchTableColumn,onChange:e=>b(a=>({...a,matchTableColumn:e.target.value})),children:[(0,t.jsx)("option",{value:"",children:"选择匹配表格列"}),p.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,t.jsxs)("select",{className:"flex-1 min-w-[200px] p-2 border rounded-md",value:f.sourceColumn,onChange:e=>b(a=>({...a,sourceColumn:e.target.value})),children:[(0,t.jsx)("option",{value:"",children:"选择源表格列"}),s.map(e=>(0,t.jsx)("option",{value:e.name,children:e.name},e.name))]}),(0,t.jsxs)("select",{className:"flex-1 min-w-[150px] p-2 border rounded-md",value:f.matchType,onChange:e=>b(a=>({...a,matchType:e.target.value})),children:[(0,t.jsx)("option",{value:"exact",children:"完全匹配"}),(0,t.jsx)("option",{value:"contains",children:"包含"}),(0,t.jsx)("option",{value:"startsWith",children:"开头匹配"}),(0,t.jsx)("option",{value:"endsWith",children:"结尾匹配"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-border",children:[(0,t.jsx)("div",{}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(g,{onClick:()=>{b({matchTableColumn:"",sourceColumn:"",matchType:"exact"}),l(a)},variant:"outline",className:"flex items-center gap-2",children:[(0,t.jsx)(d.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"重置"})]}),(0,t.jsxs)(g,{onClick:()=>{if(!f.matchTableColumn||!f.sourceColumn){l([]);return}let e=new Set(x.map(e=>String(e[f.matchTableColumn]).trim().toLowerCase()));if(0===e.size){l([]);return}let s=a.filter(a=>{let s=String(a[f.sourceColumn]).trim().toLowerCase();switch(f.matchType){case"exact":return e.has(s);case"contains":return Array.from(e).some(e=>s.includes(e));case"startsWith":return Array.from(e).some(e=>s.startsWith(e));case"endsWith":return Array.from(e).some(e=>s.endsWith(e));default:return!1}});l(s.length>0?s:[])},className:"flex items-center gap-2",disabled:!f.matchTableColumn||!f.sourceColumn,children:[(0,t.jsx)(u.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"应用匹配"})]}),(0,t.jsxs)("select",{className:"px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/20",value:j,onChange:e=>N(e.target.value),children:[(0,t.jsx)("option",{value:"csv",children:"CSV"}),(0,t.jsx)("option",{value:"xls",children:"XLS"}),(0,t.jsx)("option",{value:"json",children:"JSON"})]}),(0,t.jsxs)(g,{onClick:()=>null==i?void 0:i(j),className:"flex items-center gap-2",disabled:!f.matchTableColumn||!f.sourceColumn,children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"导出"})]})]})]})]})})}function H(){let[e,a]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[m,x]=(0,r.useState)(1),[h,p]=(0,r.useState)(10),[v,f]=(0,r.useState)(""),[b,j]=(0,r.useState)("filter"),[N,y]=(0,r.useState)([]),w=async e=>{try{let s=[],t=e.name.toLowerCase();if(t.endsWith(".csv"))s=(await M(e)).data;else if(t.endsWith(".xlsx")||t.endsWith(".xls")){let a=await e.arrayBuffer(),t=o.LF(a),r=t.SheetNames[0],l=t.Sheets[r];s=o.Wp.sheet_to_json(l)}else throw Error("不支持的文件格式，请上传 .csv, .xls 或 .xlsx 文件");let r=O(s);a(s),i(r),u(s),x(1),f("")}catch(e){console.error("Error parsing file:",e),f("解析文件出错，请确保是有效的 CSV 或 Excel 文件。")}},S=e=>{let a="match"===b&&N.length>0?N:d;if(0===a.length)return;let t="",r="export-".concat(Date.now()),l="";switch(e){case"csv":t=s.map(e=>e.name).join(",")+"\n"+a.map(e=>s.map(a=>'"'.concat(String(e[a.name]).replace(/"/g,'""'),'"')).join(",")).join("\n"),r+=".csv",l="text/csv;charset=utf-8";break;case"json":t=JSON.stringify(a,null,2),r+=".json",l="application/json;charset=utf-8";break;case"xls":t='\n          <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel">\n            <head>\n              <meta charset="UTF-8">\n              <!--[if gte mso 9]>\n              <xml>\n                <x:ExcelWorkbook>\n                  <x:ExcelWorksheets>\n                    <x:ExcelWorksheet>\n                      <x:Name>Sheet1</x:Name>\n                      <x:WorksheetOptions>\n                        <x:DisplayGridlines/>\n                      </x:WorksheetOptions>\n                    </x:ExcelWorksheet>\n                  </x:ExcelWorksheets>\n                </x:ExcelWorkbook>\n              </xml>\n              <![endif]-->\n            </head>\n            <body>\n              <table>\n                <tr>\n                  '.concat(s.map(e=>'<th style="background-color: #f3f4f6; font-weight: bold;">'.concat(e.name,"</th>")).join(""),"\n                </tr>\n                ").concat(a.map(e=>"<tr>".concat(s.map(a=>"<td>".concat(String(e[a.name]).replace(/[<>]/g,""),"</td>")).join(""),"</tr>")).join(""),"\n              </table>\n            </body>\n          </html>\n        "),r+=".xls",l="application/vnd.ms-excel;charset=utf-8"}let n=new Blob(["\uFEFF"+t],{type:l}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=r,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)},k=(0,r.useMemo)(()=>"filter"===b?d.slice((m-1)*h,m*h):N.slice((m-1)*h,m*h),[b,d,N,m,h]),Y=(0,r.useMemo)(()=>Math.ceil(("filter"===b?d.length:N.length)/h),[b,d.length,N.length,h]);return(0,r.useEffect)(()=>{x(1)},[b,N.length,d.length]),(0,t.jsx)("div",{className:"",children:(0,t.jsx)("div",{className:"max-w-[1600px] mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"flex flex-col lg:flex-row gap-8",children:(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.A,{className:"h-8 w-8 text-primary"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-primary",children:"CSV 查询工具"})]}),e.length>0&&(0,t.jsxs)(g,{onClick:()=>{a([]),i([]),u([]),y([]),x(1),j("filter")},variant:"outline",className:"flex items-center gap-2",children:[(0,t.jsx)(n.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"重新上传源表格"})]})]}),v&&(0,t.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:v}),e.length>0&&(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("div",{className:"border-b border-border",children:(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("button",{className:"px-4 py-2 font-medium ".concat("filter"===b?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"),onClick:()=>{j("filter"),y([]),x(1)},children:"条件筛选"}),(0,t.jsx)("button",{className:"px-4 py-2 font-medium ".concat("match"===b?"text-primary border-b-2 border-primary":"text-gray-500 hover:text-gray-700"),onClick:()=>{j("match"),y(e)},children:"表格匹配"})]})})}),(0,t.jsx)("div",{className:"space-y-6",children:0===e.length?(0,t.jsx)(c,{onFileSelect:w,acceptExcel:!0}):(0,t.jsxs)(t.Fragment,{children:["filter"===b?(0,t.jsx)(C,{columns:s,onQueryChange:a=>{u(e.filter(e=>{let s=a.filters.map(a=>(function(e,a){let s=e[a.column];if("isNull"===a.operator)return null==s||""===s;if("isNotNull"===a.operator)return null!=s&&""!==s;if(!s)return!1;switch(a.columnType){case"date":return function(e,a){let s=z()(e),t=z()(a.value);switch(a.operator){case"before":return s.isBefore(t);case"after":return s.isAfter(t);case"onDate":return s.isSame(t,"day");case"between":let[r,l]=a.value;return s.isAfter(z()(r))&&s.isBefore(z()(l));default:return!1}}(s,a);case"number":return function(e,a){let s=Number(e),t=Number(a.value);switch(a.operator){case"equals":return s===t;case"notEquals":return s!==t;case"greaterThan":return s>t;case"lessThan":return s<t;case"between":let[r,l]=a.value.map(Number);return s>=r&&s<=l;default:return!1}}(s,a);default:return function(e,a){let s=e.toLowerCase(),t=a.value.toLowerCase();switch(a.operator){case"equals":return s===t;case"notEquals":return s!==t;case"contains":return s.includes(t);case"notContains":return!s.includes(t);case"startsWith":return s.startsWith(t);case"endsWith":return s.endsWith(t);default:return!1}}(String(s),a)}})(e,a));return"AND"===a.conjunction?s.every(Boolean):s.some(Boolean)})),x(1)},onExport:S}):(0,t.jsx)(_,{sourceData:e,sourceColumns:s,onMatch:y,onExport:S}),(0,t.jsx)("div",{className:"overflow-hidden opacity-[.98] shadow-lg hover:shadow-xl",children:(0,t.jsx)(E,{data:k,columns:s.map(e=>e.name),currentPage:m,totalPages:Y,pageSize:h,onPageChange:x,onPageSizeChange:e=>{p(e),x(1)}})})]})})]})})})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[524,270,441,517,358],()=>a(763)),_N_E=e.O()}]);